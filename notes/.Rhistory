library(knitr)
opts_chunk$set(echo = TRUE)
library(icjiar)
library(dplyr)
ispcrime_tbl <- tibble::as.tibble(ispcrime)
regions_tbl <- tibble::as.tibble(regions)
ispcrime_tbl
# peak at the first rows of the data
ispcrime_tbl
# get annual average count of violent crime by county
ispcrime_tbl %>%
group_by(county) %>%
summarise(annualAvgCrime = sum(violentCrime, propertyCrime, na.rm = TRUE) / length(unique(year)))
# sort by average crime count?
ispcrime_tbl %>%
group_by(county) %>%
summarise(annualAvgCrime = sum(violentCrime, propertyCrime, na.rm = TRUE) / length(unique(year))) %>%
arrange(desc(annualAvgCrime))
# sort by average crime count?
ispcrime_tbl %>%
group_by(county) %>%
summarise(annualAvgCrime = sum(violentCrime, propertyCrime, na.rm = TRUE) / nrow()) %>%
arrange(desc(annualAvgCrime))
# sort by average crime count?
ispcrime_tbl %>%
group_by(county) %>%
summarise(annualAvgCrime = sum(violentCrime, propertyCrime, na.rm = TRUE) / length(unique(year))) %>%
arrange(desc(annualAvgCrime))
# sort by average crime count?
ispcrime_tbl %>%
group_by(county) %>%
summarise(annualAvgCrime = sum(violentCrime, propertyCrime, na.rm = TRUE) / n()) %>%
arrange(desc(annualAvgCrime))
# get annual average count of violent crime by county
ispcrime_tbl %>%
group_by(county) %>%
summarise(annualAvgCrime = sum(violentCrime, propertyCrime, na.rm = TRUE) / n())
library(ggplot2)
library(RColorBrewer)
ispcrime_tbl2 <- left_join(ispcrime_tbl, regions) %>% na.omit()
# histogram of violent crime count by county
ggplot(ispcrime_tbl2, aes(x = violentCrime)) +
geom_histogram(binwidth = 100) +
facet_wrap(~ year) +
labs(x = "Violent crime count", y = "Count") +
theme_minimal(base_size = 15)
# exclude Cook county data from the histogram and add colors
ggplot(filter(ispcrime_tbl2, county != "Cook"), aes(x = violentCrime, fill = Year)) +
geom_histogram(binwidth = 100) + facet_wrap(~ Year) +
labs(x = "Violent crime count", y = "Count") +
theme_minimal(base_size = 15)
filter(ispcrime_tbl2, county != "Cook")
# exclude Cook county data from the histogram and add colors
ggplot(filter(ispcrime_tbl2, county != "Cook"), aes(x = violentCrime, fill = year)) +
geom_histogram(binwidth = 100) + facet_wrap(~ year) +
labs(x = "Violent crime count", y = "Count") +
theme_minimal(base_size = 15)
library(ggplot2)
library(RColorBrewer)
ispcrime_tbl2 <- left_join(ispcrime_tbl, regions) %>% na.omit() %>% mutate(Year = as.factor(year))
# histogram of violent crime count by county
ggplot(ispcrime_tbl2, aes(x = violentCrime)) +
geom_histogram(binwidth = 100) +
facet_wrap(~ Year) +
labs(x = "Violent crime count", y = "Count") +
theme_minimal(base_size = 15)
# exclude Cook county data from the histogram and add colors
ggplot(filter(ispcrime_tbl2, county != "Cook"), aes(x = violentCrime, fill = Year)) +
geom_histogram(binwidth = 100) + facet_wrap(~ Year) +
labs(x = "Violent crime count", y = "Count") +
theme_minimal(base_size = 15)
# histogram of violent crime count by county
ggplot(ispcrime_tbl2, aes(x = violentCrime)) +
geom_histogram() +
facet_wrap(~ Year) +
labs(x = "Violent crime count", y = "Count") +
theme_minimal()
# exclude Cook county data from the histogram and add colors
ggplot(filter(ispcrime_tbl2, county != "Cook"), aes(x = violentCrime, fill = Year)) +
geom_histogram() + facet_wrap(~ Year) +
labs(x = "Violent crime count", y = "Count") +
theme_minimal()
# exclude Cook county data from the histogram and add colors
ggplot(filter(ispcrime_tbl2, county != "Cook"), aes(x = violentCrime, fill = Year)) +
geom_histogram(binwidth = 200) + facet_wrap(~ Year) +
labs(x = "Violent crime count", y = "Count") +
theme_minimal()
# histogram of violent crime count by county
ggplot(ispcrime_tbl2, aes(x = violentCrime)) +
geom_histogram(binwidth = 200) +
facet_wrap(~ Year) +
labs(x = "Violent crime count", y = "Count") +
theme_minimal()
