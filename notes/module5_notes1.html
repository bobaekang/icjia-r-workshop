<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Bobae Kang" />

<meta name="date" content="2018-04-18" />

<title>R Workshop: Module 5 (1)</title>

<script src="notes_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="notes_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="notes_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="notes_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="notes_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="notes_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="notes_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="notes_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="notes_files/navigation-1.1/tabsets.js"></script>
<link href="notes_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="notes_files/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="../css/style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="header">



<h1 class="title toc-ignore">R Workshop: Module 5 (1)</h1>
<h4 class="author"><em>Bobae Kang</em></h4>
<h4 class="date"><em>April 18, 2018</em></h4>

</div>


<!-- fontawesome CDN -->
<p><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"></p>
<!-- logo -->
<div class="logo">
<p><a href="http://www.icjia.state.il.us/"><img src="../images/icjia.png" alt="ICJIA logo"></img></a></p>
</div>
<p>This page contains the notes for <strong>the first part of R Workshop Module 5: Statistical modeling with R</strong>, which is part of the R Workshop series prepared by ICJIA Research Analyst <a href="http://www.icjia.state.il.us/biographies/bobae-kang">Bobae Kang</a> to enable and encourage ICJIA researchers to take advantage of R, a statistical programming language that is one of the most powerful modern research tools.</p>
<div id="links" class="section level3">
<h3>Links</h3>
<p>Click <a href="../index.html"><strong>here</strong></a> to go to the workshop <strong>home page</strong>.</p>
<p>Click <a href="../modules.html"><strong>here</strong></a> to go to the workshop <strong>Modules page</strong>.</p>
<p>Click <a href="../slides/module5_slides1.html"><strong>here</strong></a> to view the accompanying <strong>slides for Module 5, Part 1</strong>.</p>
<p>Navigate to the other workshop materials:</p>
<button class="btn" data-toggle="collapse" data-target="#collapse-navigate" aria-expanded="false" aria-controls="collapse-navigate">
<strong>SEE MORE</strong>
</button>
<div id="collapse-navigate" class="collapse mt-1">
<div style="padding:20px;">
<ul>
<li><strong>Module 1: Introduction to R</strong> (<a href="../slides/module1_slides.html"><strong>slides</strong></a>, <a href="module1_notes.html"><strong>note</strong></a>)</li>
<li><strong>Module 2: R basics</strong>
<ul>
<li>Part 1 (<a href="../slides/module2_slides1.html"><strong>slides</strong></a>, <a href="module2_notes1.html"><strong>note</strong></a>)</li>
<li>Part 2 (<a href="../slides/module2_slides2.html"><strong>slides</strong></a>, <a href="module2_notes2.html"><strong>note</strong></a>)</li>
</ul></li>
<li><strong>Module 3: Data analysis with R</strong>
<ul>
<li>Part 1 (<a href="../slides/module3_slides1.html"><strong>slides</strong></a>, <a href="module3_notes1.html"><strong>note</strong></a>)</li>
<li>Part 2 (<a href="../slides/module3_slides2.html"><strong>slides</strong></a>, <a href="module3_notes2.html"><strong>note</strong></a>)</li>
</ul></li>
<li><strong>Module 4: Data visualization with R</strong>
<ul>
<li>Part 1 (<a href="../slides/module4_slides1.html"><strong>slides</strong></a>, <a href="module4_notes1.html"><strong>note</strong></a>)</li>
<li>Part 2 (<a href="../slides/module4_slides2.html"><strong>slides</strong></a>, <a href="module4_notes2.html"><strong>note</strong></a>)</li>
</ul></li>
<li><strong>Module 5: Statistical modeling with R</strong>
<ul>
<li>Part 2 (<a href="../slides/module5_slides2.html"><strong>slides</strong></a>, <a href="module5_notes2.html"><strong>note</strong></a>)</li>
</ul></li>
<li><strong>Module 6: “To Infinity and Beyond”</strong>
<ul>
<li>Part 1 (<a href="../slides/module6_slides1.html"><strong>slides</strong></a>, <a href="module6_notes1.html"><strong>note</strong></a>)</li>
<li>Part 2 (<a href="../slides/module6_slides2.html"><strong>slides</strong></a>, <a href="module6_notes2.html"><strong>note</strong></a>)</li>
</ul></li>
</ul>
</div>
</div>
<hr />
</div>
<div id="statistical-modleing-with-r-1-basics-of-statistical-modeling" class="section level1">
<h1>Statistical modleing with R (1): Basics of statistical modeling</h1>
<p>R is first designed as a programming language and an environment for statistics and data analysis. Accordingly, R provides as part of its base packages a host of handy tools for conducting statistical analysis. This part introduces the basics of descriptive and inferential statistics in R and touches on fitting linear and generalized linear models.</p>
<hr />
</div>
<div id="basic-descriptive-statistics" class="section level1">
<h1>Basic Descriptive Statistics</h1>
<img src="../images/vadlo_descriptive_statistics.gif" width="50%" style="display: block; margin: auto; box-shadow: none;" />
<p style="font-size:0.5em; text-align:center; color: #777;">
Source: <a href="http://vadlo.com/cartoons.php?id=196">Vadlo.com</a>
</p>
<div id="quick-summary-stats" class="section level2">
<h2>Quick summary stats</h2>
<pre class="r"><code>summary(data)</code></pre>
<p>The Base R <code>summary()</code> function is a quick way to get descriptive statistics on each columan of a tabular data object.</p>
<p>For numerical columns, we get the minimum, 1st quartile, median, mean, 3rd quartie and maximum values, as well as the count of missing value (<code>NA</code>).</p>
<p>For categorical variables (e.g. <code>factor</code>), we can the count for each level as well as the missing value (<code>NA</code>).</p>
<p><code>summary()</code> is also used to get the “summary” of a fitted model object (e.g. <code>lm</code>) as well, as we will see shortly.</p>
<div id="example" class="section level3">
<h3>Example</h3>
<p>Let’s take a look at <code>summary</code> of the <code>ispcrime</code> dataset.</p>
<pre class="r"><code>summary(ispcrime)</code></pre>
<pre><code>##       year            county     violentCrime       murder       
##  Min.   :2011   Adams    :  5   Min.   :    0   Min.   :  0.000  
##  1st Qu.:2012   Alexander:  5   1st Qu.:   19   1st Qu.:  0.000  
##  Median :2013   Bond     :  5   Median :   42   Median :  0.000  
##  Mean   :2013   Boone    :  5   Mean   :  501   Mean   :  7.026  
##  3rd Qu.:2014   Brown    :  5   3rd Qu.:  133   3rd Qu.:  1.000  
##  Max.   :2015   Bureau   :  5   Max.   :33348   Max.   :566.000  
##                 (Other)  :480   NA&#39;s   :7       NA&#39;s   :7        
##       rape            robbery          aggAssault      propertyCrime   
##  Min.   :   0.00   Min.   :    0.0   Min.   :    0.0   Min.   :     0  
##  1st Qu.:   1.00   1st Qu.:    0.0   1st Qu.:   15.0   1st Qu.:   133  
##  Median :   6.00   Median :    2.0   Median :   33.0   Median :   349  
##  Mean   :  41.29   Mean   :  172.3   Mean   :  280.4   Mean   :  2913  
##  3rd Qu.:  22.00   3rd Qu.:   13.0   3rd Qu.:  102.0   3rd Qu.:  1190  
##  Max.   :1986.00   Max.   :16095.0   Max.   :15129.0   Max.   :178902  
##  NA&#39;s   :7         NA&#39;s   :7         NA&#39;s   :7         NA&#39;s   :7       
##     burglary         larcenyTft           MVTft             arson        
##  Min.   :    0.0   Min.   :     0.0   Min.   :    0.0   Min.   :   0.00  
##  1st Qu.:   35.5   1st Qu.:    85.5   1st Qu.:    3.0   1st Qu.:   1.00  
##  Median :   79.0   Median :   258.0   Median :   10.0   Median :   2.00  
##  Mean   :  589.3   Mean   :  2084.9   Mean   :  215.2   Mean   :  23.45  
##  3rd Qu.:  268.0   3rd Qu.:   852.0   3rd Qu.:   30.0   3rd Qu.:   8.50  
##  Max.   :38485.0   Max.   :116145.0   Max.   :22879.0   Max.   :1418.00  
##  NA&#39;s   :7         NA&#39;s   :7          NA&#39;s   :7         NA&#39;s   :7</code></pre>
</div>
</div>
<div id="numerical-variables" class="section level2">
<h2>Numerical variables</h2>
<p>A distribution of numerical values can be described using statistics on the following characteristics:</p>
<ul>
<li>Central tendency</li>
<li>Variability</li>
<li>Shape</li>
<li>Outliers</li>
</ul>
<p>In the following, we will briefly discuss what each of these characteristics means and how we can get relevant statistics in R.</p>
<div id="central-tendency" class="section level3">
<h3>Central tendency</h3>
<p>In statistics, central tendency is concerned with the “center” of a distribution. The following three are the common measures of central tendency:</p>
<ul>
<li>“mean” for the arithmetic mean</li>
<li>“median” for the 50th percentile</li>
<li>“mode” for the most frequent value</li>
</ul>
<p>R has built-in functions for the first two: <code>mean()</code> and <code>median()</code>. Unfortunately, there is no native R function for mode. However, it is possible to create a custom function using the definition, i.e. the most frequnt value. Also, check out the <code>modeest</code> package that offers mode estimators.</p>
<p>Let us try using <code>mean()</code> and <code>median()</code> for the <code>violentCrime</code> column. And the result is …</p>
<pre class="r"><code>mean(ispcrime$violentCrime)</code></pre>
<pre><code>## [1] NA</code></pre>
<pre class="r"><code>median(ispcrime$violentCrime)</code></pre>
<pre><code>## [1] NA</code></pre>
<p>… wait, what? We get <code>NA</code> for both values.</p>
<p>This is because <code>NA</code> in R is a “contagious” value, making any operation with missing values return <code>NA</code>. To remedy this, we can use the <code>na.rm</code> argument, which takes a boolean input to control weather whether <code>NA</code> values are removed/excluded in calculation. The default is <code>na.rm = FALSE</code></p>
<p>We try again with <code>na.rm = TRUE</code>:</p>
<pre class="r"><code>mean(ispcrime$violentCrime, na.rm = TRUE)</code></pre>
<pre><code>## [1] 500.9702</code></pre>
<pre class="r"><code>median(ispcrime$violentCrime, na.rm = TRUE)</code></pre>
<pre><code>## [1] 42</code></pre>
</div>
<div id="variability" class="section level3">
<h3>Variability</h3>
<p>Variability (or dispersion) in statistics is concerned with the extent to which a distribution is spreaded out.</p>
<p>There exist various measures for variability and R has built-in functions for many of them:</p>
<ul>
<li>range: <code>min()</code>, <code>max()</code>, <code>range()</code></li>
<li>percentiles: <code>fivenum()</code>, <code>IQR()</code>, <code>quantile()</code></li>
<li>variance: <code>var()</code>, <code>sd()</code></li>
</ul>
<div id="range" class="section level4">
<h4>Range</h4>
<p>Range is the interval between the minium nad maximum values. R offers <code>min</code> for getting the minimum value, <code>max()</code> for the maximum value, and <code>range()</code> for the range. Each of functions has the <code>na.rm</code> argument, so make sure change its input as needed.</p>
<pre class="r"><code>min(ispcrime$violentCrime, na.rm = TRUE)</code></pre>
<pre><code>## [1] 0</code></pre>
<pre class="r"><code>max(ispcrime$violentCrime, na.rm = TRUE)</code></pre>
<pre><code>## [1] 33348</code></pre>
<pre class="r"><code>range(ispcrime$violentCrime, na.rm = TRUE)</code></pre>
<pre><code>## [1]     0 33348</code></pre>
</div>
<div id="percentiles" class="section level4">
<h4>Percentiles</h4>
<p>R has a few useful functions to inspect the distribution of numerical data in terms of percentiles.</p>
<p>The <code>fivenum()</code> function returns what is called Tukey’s five number summary (minumum, 1st quartile, median, 3rd qurtile, maximum) for the input data. <code>IQR()</code> returns the inter-quartile range, which is the difference between the 1st quartile (25%) and 3rd quartile (75%).</p>
<p>The following shows the outputs of these functions using <code>violentCrime</code> as the input:</p>
<pre class="r"><code>fivenum(ispcrime$violentCrime, na.rm = TRUE)</code></pre>
<pre><code>## [1]     0    19    42   133 33348</code></pre>
<pre class="r"><code>IQR(ispcrime$violentCrime, na.rm = TRUE)</code></pre>
<pre><code>## [1] 114</code></pre>
<p><code>quntile()</code> is a somewhat more flexible function. The default setting output of <code>quantile()</code> is equal to <code>fivenum()</code> output. However, <code>quantile()</code> can use <code>probs</code> arugment to get more flexible output.</p>
<pre class="r"><code># default: equal to fivenum()
quantile(ispcrime$violentCrime, probs = seq(0, 1, 0.25), na.rm = TRUE)</code></pre>
<pre><code>##    0%   25%   50%   75%  100% 
##     0    19    42   133 33348</code></pre>
<pre class="r"><code>quantile(ispcrime$violentCrime, probs = seq(0, 1, 0.1), na.rm = TRUE)</code></pre>
<pre><code>##      0%     10%     20%     30%     40%     50%     60%     70%     80% 
##     0.0     5.0    13.0    24.0    32.0    42.0    57.0    90.0   246.2 
##     90%    100% 
##   668.4 33348.0</code></pre>
</div>
<div id="variance" class="section level4">
<h4>Variance</h4>
<p>The R function for variance is <code>var()</code>, which returns the sample variance of the given data: <span class="math display">\[s^2 = (\sum{x - \bar{x}}^2)/(n-1)\]</span></p>
<pre class="r"><code>var(ispcrime$violentCrime, na.rm = TRUE)</code></pre>
<pre><code>## [1] 9463013</code></pre>
<p>Similarly, <code>sd()</code> returns the standard deviation of the given data: <span class="math display">\[s = \sqrt{(\sum{x - \bar{x}}^2)/(n-1)}\]</span></p>
<pre class="r"><code>sd(ispcrime$violentCrime, na.rm = TRUE)</code></pre>
<pre><code>## [1] 3076.201</code></pre>
<p>Note that <code>var()</code> returns a covariance matrix when multiple variables are given as its input. In such cases, another function named <code>cov()</code> can be used instead for clarity; however, <code>cov()</code> has no <code>na.rm</code> argument to handle missing values.</p>
<pre class="r"><code>variables &lt;- ispcrime %&gt;% select(violentCrime, propertyCrime)
var(variables, na.rm = TRUE)</code></pre>
<pre><code>##               violentCrime propertyCrime
## violentCrime       9463013      46803865
## propertyCrime     46803865     234761775</code></pre>
</div>
</div>
<div id="shape" class="section level3">
<h3>Shape</h3>
<p>The skewness and kurtosis (fatness/thinness) of a distribution are called the “shape” of the distribution.</p>
<p>While base R has no functions to get these statistics (which are rarely used for common descriptive statistics anyway), the <code>moments</code> package offers the following functions to meaasure the shape of a distribution:</p>
<ul>
<li><code>skewness()</code></li>
<li><code>kurtosis()</code></li>
</ul>
<p>See <code>moments</code> package’s <a href="https://cran.r-project.org/web/packages/moments/moments.pdf">reference manual</a> to find out more.</p>
</div>
<div id="outliers" class="section level3">
<h3>Outliers</h3>
<p>Outliers are observations or data points that are far from most other observations and disproportinately affect key summary statistics</p>
<p>The <code>outliers</code> package offers useful functions to detect and measure outliers in data. See <code>outliers</code> package’s <a href="https://cran.r-project.org/web/packages/outliers/outliers.pdf">reference manual</a> to learn more.</p>
</div>
</div>
<div id="categorical-variables" class="section level2">
<h2>Categorical variables</h2>
<p>Inspecting the distribution of a categorical variable requires a different set of tools. Frequency table is one of the most common ways to summarize the distribution of a catagorical variable.</p>
<p>In R, frequency tables can be made using table functions. We will take a look at the following:</p>
<ul>
<li><code>table()</code> for generating frequency tables</li>
<li><code>prop.table()</code> for tables of proportions</li>
<li><code>xtabs()</code> for creating frequency tables using formula</li>
<li><code>ftable()</code> for creating “flat” contingency tables</li>
</ul>
<div id="table-functions" class="section level3">
<h3>Table functions</h3>
<pre class="r"><code>table(...)
prop.table(x, margin = NULL)
ftable(x)
xtabs(formula, data, ...)</code></pre>
<p><code>table()</code> takes one or more data vectors of same length. Each input data can be named like in the case of creating a <code>list</code> or a <code>data.frame</code> object. We can use <code>as.data.frame()</code> to turn a <code>table</code> into a data frame.</p>
<p>Both <code>prop.table()</code> and <code>ftable()</code> takes a <code>table</code> object. <code>prop.table()</code> returns a table in terms of proportion, where <span class="math inline">\(0 \leq p \leq 1\)</span> for each value. <code>ftable()</code> returns a <code>flat</code> contingency table. We will shorty see what this means with an example below.</p>
<p>Finally, <code>xtabs</code> use formula to generate a frequency table. If a data frame is provided as the <code>data</code> input, its column names can be used directly in formula.</p>
</div>
<div id="table-example" class="section level3">
<h3><code>table()</code> example</h3>
<p>First, let us create a data to use for creating tables:</p>
<pre class="r"><code>my_data &lt;- ispcrime %&gt;%
  left_join(regions) %&gt;%
  select(
    region,
    viol = violentCrime,
    prop = propertyCrime
  ) %&gt;%
  mutate(
    high_viol = ifelse(viol &gt; mean(viol, na.rm = TRUE), 1, 0),
    high_prop = ifelse(prop &gt; mean(prop, na.rm = TRUE), 1, 0)
  )</code></pre>
<pre><code>## Joining, by = &quot;county&quot;</code></pre>
<p>Now, we create a <code>table</code> object with two dimensions: <code>region</code> for regions in the state, and <code>hviol</code> for the greater-than-average violent crime count.</p>
<pre class="r"><code>my_tbl &lt;- table(
  region = my_data$region,
  hviol = my_data$high_viol
)</code></pre>
<p>Now we print the table.</p>
<pre class="r"><code>my_tbl</code></pre>
<pre><code>##           hviol
## region       0   1
##   Central  206  24
##   Cook       0   5
##   Northern  60  25
##   Southern 175   8</code></pre>
<p>We can turn it into a <code>data.frame</code>, which can be more easily manipulated.</p>
<pre class="r"><code>as.data.frame(my_tbl)</code></pre>
<pre><code>##     region hviol Freq
## 1  Central     0  206
## 2     Cook     0    0
## 3 Northern     0   60
## 4 Southern     0  175
## 5  Central     1   24
## 6     Cook     1    5
## 7 Northern     1   25
## 8 Southern     1    8</code></pre>
</div>
<div id="prop.table-example" class="section level3">
<h3><code>prop.table()</code> example</h3>
<p><code>prop.table()</code> has a <code>margin</code> argument to control how to generate margin for. <code>magin</code> takes an index, or vector of indices as an input. Take a look at the following examples to see how <code>margin</code> argument works:</p>
<pre class="r"><code>prop.table(my_tbl, 1) # each row adds up to 1 </code></pre>
<pre><code>##           hviol
## region              0          1
##   Central  0.89565217 0.10434783
##   Cook     0.00000000 1.00000000
##   Northern 0.70588235 0.29411765
##   Southern 0.95628415 0.04371585</code></pre>
<pre class="r"><code>prop.table(my_tbl, 2) # each column adds up to 1</code></pre>
<pre><code>##           hviol
## region              0          1
##   Central  0.46712018 0.38709677
##   Cook     0.00000000 0.08064516
##   Northern 0.13605442 0.40322581
##   Southern 0.39682540 0.12903226</code></pre>
<p>If <code>margin</code> input is , each cell is <code>x/sum(x)</code>.</p>
</div>
<div id="ftable-example" class="section level3">
<h3><code>ftable()</code> example</h3>
<p>To better illustrate what <code>ftable()</code> does, we first create a table with three dimensions. This is becuase using <code>ftable()</code> for a table of 2 dimensions or less makes little difference.</p>
<pre class="r"><code>my_tbl2 &lt;- table(
  region = my_data$region,
  hviol = my_data$high_viol,
  hprop = my_data$high_prop
)</code></pre>
<p>Now, we first see the <code>ftable()</code> output.</p>
<pre class="r"><code># with ftable
ftable(my_tbl2)</code></pre>
<pre><code>##                hprop   0   1
## region   hviol              
## Central  0           197   9
##          1             1  23
## Cook     0             0   0
##          1             0   5
## Northern 0            55   5
##          1             0  25
## Southern 0           173   2
##          1             0   8</code></pre>
<p>Then compare it to the default printing otuput.</p>
<pre class="r"><code># without ftable
my_tbl2</code></pre>
<pre><code>## , , hprop = 0
## 
##           hviol
## region       0   1
##   Central  197   1
##   Cook       0   0
##   Northern  55   0
##   Southern 173   0
## 
## , , hprop = 1
## 
##           hviol
## region       0   1
##   Central    9  23
##   Cook       0   5
##   Northern   5  25
##   Southern   2   8</code></pre>
</div>
<div id="xtabs-example" class="section level3">
<h3><code>xtabs()</code> example</h3>
<p><code>xtabs()</code> creates an <code>xtabs</code> object, which is built on top of <code>table</code>. Creating one-dimensional table with <code>xtabs()</code> looks like the following:</p>
<pre class="r"><code># one-dimension
xtabs(~ region, my_data)</code></pre>
<pre><code>## region
##  Central     Cook Northern Southern 
##      230        5       85      190</code></pre>
<p>Adding more dimensions can be done usign the <code>+</code> operator in the formula:</p>
<pre class="r"><code># two-dimension
xtabs(~ region + high_viol, my_data)</code></pre>
<pre><code>##           high_viol
## region       0   1
##   Central  206  24
##   Cook       0   5
##   Northern  60  25
##   Southern 175   8</code></pre>
<hr />
</div>
</div>
</div>
<div id="basic-inferential-statistics" class="section level1">
<h1>Basic Inferential Statistics</h1>
<img src="../images/vadlo_inferential_statistics.gif" width="50%" style="display: block; margin: auto; box-shadow: none;" />
<p style="font-size:0.5em; text-align:center; color: #777;">
Source: <a href="http://vadlo.com/cartoons.php?id=407">Vadlo.com</a>
</p>
<div id="students-t-test" class="section level2">
<h2>Student’s t-test</h2>
<pre class="r"><code>t.test(x, y = NULL, alternative = c(&quot;two.sided&quot;, &quot;less&quot;, &quot;greater&quot;),
       mu = 0, conf.level = 0.95, ...)
t.test(formula, data, subset, na.action, ...)</code></pre>
<p>R offers the <code>t.test()</code> function to conduct Student’s t-test. <code>x</code> and <code>y</code> are numeric vectors of data values.</p>
<p>If only <code>x</code> is given, one sample t-test is conducted and the mean of <code>x</code> is compared agianst the <code>mu</code> value with the default of 0. If both <code>x</code> and <code>y</code> are provided, two sample t-test is conducted.</p>
<p>The test null hypothesis is no difference in the sample means, assuming that each sample comes from a normal distribution.</p>
<p><code>alternative</code> defines the alternative hypothesis, which can take the value of “two.sided” (default), “less”, or “greater”.</p>
<p>Two sample t-test can also be conducted by using <code>formula</code> (<code>y ~ x</code>) with <code>data</code> input.</p>
<div id="example-1" class="section level3">
<h3>Example</h3>
<p>Let’s take a look at an example of using <code>t.test()</code>. First we prepae <code>x</code> and <code>y</code> to use.</p>
<pre class="r"><code>ispcrime2 &lt;- left_join(ispcrime, regions)</code></pre>
<pre><code>## Joining, by = &quot;county&quot;</code></pre>
<pre class="r"><code>viol_crime_north &lt;- (filter(ispcrime2, region == &quot;Northern&quot;))$violentCrime
viol_crime_south &lt;- (filter(ispcrime2, region == &quot;Southern&quot;))$violentCrime</code></pre>
<p>Now we conduct two sample t-test using <code>viol_crime_north</code> and <code>viol_crime_south</code> with the default “two.sided” alternative hypothesis:</p>
<pre class="r"><code>t.test(viol_crime_north, viol_crime_south)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  viol_crime_north and viol_crime_south
## t = 4.4064, df = 105.49, p-value = 2.534e-05
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  176.7132 465.8398
## sample estimates:
## mean of x mean of y 
##  438.2000  116.9235</code></pre>
</div>
</div>
<div id="wilcoxon-tests" class="section level2">
<h2>Wilcoxon tests</h2>
<pre class="r"><code>wilcox.test(x, y = NULL, alternative = c(&quot;two.sided&quot;, &quot;less&quot;, &quot;greater&quot;),
            mu = 0, conf.level = 0.95, ...)
wilcox.test(formula, data, subset, na.action, ...)</code></pre>
<p>R offers <code>wilcox.test()</code> for Wilcoxon tests. It is often considered a nonparametric counterpart of the t-test, and can be performed using either one sample or two samples. Unliked in Student’s t-test, Wilcoxon test does not assume normality.</p>
<p>One sample Wilcoxon test (i.e. rank-sum test) is conducted with only <code>x</code> input is provided.</p>
<p>Two sample Wilcoxon test (singed-rank test) can be conducted by either supplying <code>x</code> and <code>y</code> inputs or using <code>formula</code> (<code>y ~ x</code>) with <code>data</code> input.</p>
</div>
<div id="analysis-of-variance" class="section level2">
<h2>Analysis of Variance</h2>
<pre class="r"><code>aov(formula, data, qr = TRUE, ...)</code></pre>
<p><code>aov()</code> is the built-in R function to perform analysis of variance (ANOVA) to analyze the differences among group means.</p>
<p>Here we use <code>formula</code> in the following format: <code>value ~ subgroup</code>. <code>data</code> is a data.frame with both <code>value</code> and <code>subgroup</code> as its columns.</p>
<p><code>summary()</code> has a method for <code>aov</code> class that returns a refined print result. Also, <code>model.tables()</code> has a method for <code>aov</code> class for reporting table of means or table of effects.</p>
<div id="example-2" class="section level3">
<h3>Example</h3>
<p>This example is to illustrate different printing methods for the ANOVA model results. We first fit the model, using <code>violentCrime</code> as the value column and <code>region</code> as the subgroup column.</p>
<pre class="r"><code>aov_by_region &lt;- aov(formula = violentCrime ~ region, data = ispcrime2)</code></pre>
<p>Here is the default printing output:</p>
<pre class="r"><code>print(aov_by_region)</code></pre>
<pre><code>## Call:
##    aov(formula = violentCrime ~ region, data = ispcrime2)
## 
## Terms:
##                     region  Residuals
## Sum of Squares  4657351567   93080910
## Deg. of Freedom          3        499
## 
## Residual standard error: 431.8969
## Estimated effects may be unbalanced
## 7 observations deleted due to missingness</code></pre>
<p>And here is using <code>summary()</code>, of which the ouput includes the F statistic and the relevant p-value:</p>
<pre class="r"><code>summary(aov_by_region)</code></pre>
<pre><code>##              Df    Sum Sq   Mean Sq F value Pr(&gt;F)    
## region        3 4.657e+09 1.552e+09    8323 &lt;2e-16 ***
## Residuals   499 9.308e+07 1.865e+05                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 7 observations deleted due to missingness</code></pre>
<p>Finally, using <code>model.tables</code> with different <code>type</code> input, we get the tables of means and effects:</p>
<pre class="r"><code>model.tables(aov_by_region, type = &quot;means&quot;)</code></pre>
<pre><code>## Tables of means
## Grand mean
##          
## 500.9702 
## 
##  region 
##     Central  Cook Northern Southern
##         170 30848    438.2    116.9
## rep     230     5     85.0    183.0</code></pre>
<pre class="r"><code>model.tables(aov_by_region, type = &quot;effects&quot;)</code></pre>
<pre><code>## Tables of effects
## 
##  region 
##     Central  Cook Northern Southern
##        -331 30347   -62.77     -384
## rep     230     5    85.00      183</code></pre>
</div>
</div>
<div id="other-statistical-tests" class="section level2">
<h2>Other statistical tests</h2>
<p>The following is a list of other statistical tests with built-in R fuctions:</p>
<pre class="r"><code># Test of equal proprtions
prop.test(x, n, p, ...)

# Chi-square test of indepndence/goodness-of-fit
chisq.test(x, y = NULL, ...)

# Shapiro-Wilk test of normality
shapiro.test(x)

# One- or two-sample Kolmogorov-Smirnov test
ks.test(x, y, ..., alternative = &quot;two.sided&quot;, exact = NULL)

# F-test to compare variances
var.test(x, y, ratio = 1, alternative = &quot;two.sided&quot;,
         conf.level = 0.95, ...)
var.test(formula, data, subset, na.action, ...)

# Test of correlation between paired samples
cor.test(x, y, alternative = &quot;two.sided&quot;, conf.level = 0.95,
         method = c(&quot;pearson&quot;, &quot;kendell&quot;, &quot;spearman&quot;), ...)</code></pre>
<hr />
</div>
</div>
<div id="linear-models" class="section level1">
<h1>Linear models</h1>
<p style="font-size:1.5em">
<span class="math display">\[y_i = \beta_0 + \beta_1 x_i + \varepsilon_i\]</span> <span class="math display">\[\boldsymbol{\text{y}} = \boldsymbol{\text{X}}^{\text{T}}\boldsymbol{\beta} + \boldsymbol{\varepsilon}\]</span>
</p>
<div id="the-lm-function" class="section level2">
<h2>The lm() function</h2>
<pre class="r"><code>lm(formula, data, subset, na.action, ...)</code></pre>
<p>R offers <code>lm()</code> to fit linear models, one of the most fundamental yet powerful tools for statistical modeling. A linear model with a single explanatory variable is called a simple linear model. A linaer model with multiple explanatory variables is called muliple linear regression model.</p>
<p>A model to be fitted is specificed according to the <code>formula</code> input. <code>data</code> is an optional argument, which can take a data frame or one of its variants. If <code>data</code> input is provided, its column names can be used directly in the formula.</p>
</div>
<div id="r-formula" class="section level2">
<h2>R formula</h2>
<pre class="r"><code>formula &lt;- y ~ x1 + x2</code></pre>
<p>Here we take a closer look at the R <code>formula</code> object.</p>
<p>The response variable is placed on the left-hand side of the tilde symbol (<code>~</code>), and the explanatory variables on the right-hand side.</p>
<p>Adding multiple explanatory variables can be done using <code>+</code> symbol. We can simply use <code>y ~ .</code> to include all other columns additively as expanatory variables.</p>
</div>
<div id="model-summary" class="section level2">
<h2>Model summary</h2>
<pre class="r"><code>lmfit &lt;- lm(formula, data)

print(lmfit) # not recommended
summary(lmfit)</code></pre>
<p>An output of <code>lm()</code> is an R object of <code>lm</code> class. Simply printing an <code>lm</code> object gives only minimal information on the fitted model.</p>
<p>In order to get a more compresensive model summary, we can we <code>summary()</code> function with a model input (e.g. <code>lm</code>).</p>
<div id="example-3" class="section level3">
<h3>Example</h3>
<p>We fit a simple linear model with <code>violentCrime</code> as the reponse variable and <code>propertyCrime</code> as the explanatory variable. The class of the fitted model object is <code>lm</code>.</p>
<pre class="r"><code>my_lmfit &lt;- lm(violentCrime ~ propertyCrime, ispcrime)
class(my_lmfit)</code></pre>
<pre><code>## [1] &quot;lm&quot;</code></pre>
<p>Here is the output for using the default printing method:</p>
<pre class="r"><code>my_lmfit</code></pre>
<pre><code>## 
## Call:
## lm(formula = violentCrime ~ propertyCrime, data = ispcrime)
## 
## Coefficients:
##   (Intercept)  propertyCrime  
##      -79.7683         0.1994</code></pre>
<p>And here is using <code>summary()</code>:</p>
<pre class="r"><code>summary(my_lmfit)</code></pre>
<pre><code>## 
## Call:
## lm(formula = violentCrime ~ propertyCrime, data = ispcrime)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2239.5    -2.2    57.0    78.3  3992.9 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   -79.768287  16.496961  -4.835 1.77e-06 ***
## propertyCrime   0.199367   0.001059 188.303  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 363.5 on 501 degrees of freedom
##   (7 observations deleted due to missingness)
## Multiple R-squared:  0.9861, Adjusted R-squared:  0.986 
## F-statistic: 3.546e+04 on 1 and 501 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div id="model-diagnostics" class="section level2">
<h2>Model diagnostics</h2>
<pre class="r"><code>plot(lmfit, which = c(1:3, 5), ...)</code></pre>
<p>Base R <code>plot()</code> function has a method for <code>lm</code> objects, which generates the following 6 diagnostics plots: * “Residuals vs Fitted” * “Normal Q-Q” * “Scale-Location” * “Cook’s distance” * “Residuals vs Leverage” * “Cook’s dist vs Leverage <span class="math inline">\(h_{ii}/(1-h_ii)\)</span>”</p>
<p>The default option only prints the first, second, third and fifth of these plots.</p>
<div id="example-4" class="section level3">
<h3>Example</h3>
<p>Let’s take a look at all six diagnostic plots for our fitted model:</p>
<pre class="r"><code>par(mfrow = c(2,3))
plot(my_lmfit, which = c(1:6))</code></pre>
<p><img src="module5_notes1_files/figure-html/unnamed-chunk-41-1.png" width="768" /></p>
</div>
</div>
<div id="model-evaluation" class="section level2">
<h2>Model evaluation</h2>
<pre class="r"><code>logLik(object, ...)
AIC(object, ..., k = 2)
BIC(object, ...) # equivalent to AIC with k = log(n)</code></pre>
<p>There are measures of model fit other than <span class="math inline">\(R^2\)</span>. For a model fitted by maximum likelihood algorithm, including the <code>lm</code> model, the following functions are available to get goodness-of-fit measures: * <code>logLik()</code> for log-liklehood value * <code>AIC()</code> for Akaike Information Criterion (with default <code>k</code>) * <code>BIC()</code> for Bayesian Information Criterion</p>
<p>We can read <a href="https://en.wikipedia.org/wiki/Maximum_likelihood_estimation">this Wikipedia article</a> for more on maximum likelihood estimation.</p>
</div>
<div id="extending-lm-formula" class="section level2">
<h2>Extending lm() formula</h2>
<p>A linear model can be extended with simple “tricks” to better fit the data. Four such tricks include:</p>
<ul>
<li>Transformating model terms</li>
<li>Including interaction terms</li>
<li>Polynomials</li>
<li>Polynomial splines</li>
</ul>
<div id="transformations" class="section level3">
<h3>Transformations</h3>
<pre class="r"><code>scale(y) ~ log(x1) + sqrt(x2) + ...</code></pre>
<p>We can transform formula terms on either side of <code>~</code> by applying a function to each term * Common transformations include: * <code>log()</code>: natural log (cf. <code>log2</code> and <code>log10</code>) * <code>exp()</code>: exponentiate * <code>sqrt()</code>: square root * <code>scale()</code>: rescale data such that the mean is 0 and the standard deviation is 1</p>
<div id="transforming-x" class="section level4">
<h4>Transforming <code>x</code></h4>
<p><img src="module5_notes1_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
</div>
<div id="transforming-y" class="section level4">
<h4>Transforming <code>y</code></h4>
<p><img src="module5_notes1_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
</div>
</div>
<div id="interactions" class="section level3">
<h3>Interactions</h3>
<pre class="r"><code>y ~ x1 + x2 + x1:x2
y ~ x1 * x2</code></pre>
<ul>
<li><code>x1:x2</code> takes the interactions of all terms in <code>x1</code> and <code>x2</code></li>
<li><code>x1*x2</code> is equivalent to <code>x1:x2</code> <em>and</em> the original terms <code>x1</code> and <code>x2</code></li>
<li>It is recommended to use an interaction term with all the original terms</li>
</ul>
</div>
<div id="polynomials" class="section level3">
<h3>Polynomials</h3>
<pre class="r"><code>y ~ ploy(x, degree = n)
y ~ x + I(x^2) + I(x^3) + ...</code></pre>
<ul>
<li><code>poly()</code> generates the n-th degree polynimals of the input <code>x</code></li>
<li><code>ploy(x, 3)</code> is equivalent to using <code>x + I(x^2) + I(x^3)</code>
<ul>
<li><code>I()</code> ensures the <code>^</code> with a symbol is used as an arithmetic operator</li>
</ul></li>
</ul>
</div>
<div id="polynomial-splines" class="section level3">
<h3>Polynomial splines</h3>
<pre class="r"><code>library(splines) # part of R &quot;base pacakges&quot;
y ~ ns(x, ...)
y ~ bs(x, degree = n, ...)</code></pre>
<ul>
<li><code>ns()</code> is used for the natural cubic splines</li>
<li><code>bs()</code> is used for the n-th degree polynomial splines
<ul>
<li>equivalent to <code>bs(x, degree = 3)</code></li>
</ul></li>
</ul>
</div>
</div>
<div id="broom-package" class="section level2">
<h2><code>broom</code> package</h2>
<ul>
<li><code>broom</code> is a <code>tidyverse</code> package for “tidying up” statistical model outputs in R, i.e., converting them into tidy data frames.</li>
<li><code>broom</code> functions:</li>
<li><code>glance()</code></li>
<li><code>tidy()</code></li>
<li><code>augment()</code></li>
<li>Visit <code>broom</code> <a href="https://github.com/tidyverse/broom">GitHub repository</a> and “<code>broom</code> as well as <code>dplyr</code>” <a href="https://cran.r-project.org/web/packages/broom/vignettes/broom_and_dplyr.html">vignette</a> for more</li>
</ul>
<div id="broom-functions" class="section level3">
<h3><code>broom</code> functions</h3>
<pre class="r"><code>glance(x, ...)
tidy(x, ...)
augment(x, ...)</code></pre>
<ul>
<li><code>glance()</code> takes a model object and returns a concise one-row summary of the model.</li>
<li><code>tidy()</code> takes a model object and returns a <code>data.frame</code> with the coeffcient estimation results</li>
<li><code>augment()</code> takes a model object and returns a <code>data.frame</code> for each observation with additional columns such as predictions, residuals and cluster assignments</li>
</ul>
<pre class="r"><code>glance(my_lmfit)</code></pre>
<pre><code>##   r.squared adj.r.squared    sigma statistic p.value df    logLik      AIC
## 1 0.9860675     0.9860396 363.4653  35457.96       0  2 -3678.253 7362.506
##        BIC deviance df.residual
## 1 7375.168 66185630         501</code></pre>
<pre class="r"><code>tidy(my_lmfit)</code></pre>
<pre><code>##            term    estimate   std.error  statistic      p.value
## 1   (Intercept) -79.7682868 16.49696109  -4.835332 1.771126e-06
## 2 propertyCrime   0.1993675  0.00105876 188.302852 0.000000e+00</code></pre>
<pre class="r"><code># check the class of each output
c(class(glance(my_lmfit)), class(glance(my_lmfit)))</code></pre>
<pre><code>## [1] &quot;data.frame&quot; &quot;data.frame&quot;</code></pre>
<pre class="r"><code>head(augment(my_lmfit))</code></pre>
<pre><code>##   .rownames violentCrime propertyCrime   .fitted  .se.fit     .resid
## 1         1          218          1555 230.24816 16.26976 -12.248156
## 2         2          119           290 -21.95172 16.44233 140.951715
## 3         3            6           211 -37.70175 16.45666  43.701747
## 4         4           59           733  66.36808 16.36964  -7.368081
## 5         5            7            38 -72.19232 16.48949  79.192322
## 6         6           42           505  20.91229 16.40542  21.087706
##          .hat   .sigma      .cooksd  .std.resid
## 1 0.002003718 363.8282 1.142258e-06 -0.03373209
## 2 0.002046448 363.7739 1.545129e-04  0.38819703
## 3 0.002050017 363.8234 1.487927e-05  0.12035979
## 4 0.002028394 363.8285 4.184743e-07 -0.02029235
## 5 0.002058203 363.8113 4.905554e-05  0.21810593
## 6 0.002037270 363.8274 3.442885e-06  0.05807767</code></pre>
<pre class="r"><code>class(augment(my_lmfit))</code></pre>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
</div>
</div>
<div id="modelr-package" class="section level2">
<h2><code>modelr</code> package</h2>
<p><code>modelr</code> is a <code>tidyverse</code> package that provides helper functions for statistical modeling in R. Its helper functions are designed to facilitate the following:</p>
<ul>
<li>partitioning and sampling</li>
<li>model quality metrics</li>
<li>interacting with models</li>
</ul>
<p>You can visit <code>modelr</code> <a href="https://github.com/tidyverse/modelr">GitHub repository</a> or read the <a href="http://r4ds.had.co.nz/model-basics.html">“Model Basics” chapter</a> in <em>R for Data Science</em> to learn more about the package.</p>
<div id="partitioning-and-sampling" class="section level3">
<h3>Partitioning and sampling</h3>
<pre class="r"><code>resample(data, idx)
resample_partition(data, p)
bootstrap(data, n, id = &quot;.id&quot;)</code></pre>
</div>
<div id="model-quality-metrics" class="section level3">
<h3>Model quality metrics</h3>
<pre class="r"><code>rmse(model, data)
mae(model, data)
qae(model, data, probs = c(0.05, 0.25, 0.5, 0.75, 0.95))
rsquare(model, data)</code></pre>
<ul>
<li><code>rmse()</code> returns the root mean squared error</li>
<li><code>mae()</code> returns the mean abosolute error</li>
<li><code>qae()</code> returns quantiles of absolute error</li>
<li><code>rsquare()</code> returns the <span class="math inline">\(R^2\)</span> value, i.e. the variance of the predictions divided by the variance of the reponse</li>
</ul>
</div>
<div id="interacting-with-models" class="section level3">
<h3>Interacting with models</h3>
<pre class="r"><code>add_predictions(data, model, var = &quot;pred&quot;)
add_residuals(data, model, var = &quot;resid&quot;)</code></pre>
<ul>
<li><code>add_predictions()</code> adds a new column to a data frame for predicted values based on a model</li>
<li><code>add_residuals()</code> adds a new column to a data frame for residuals based on a model</li>
</ul>
<pre class="r"><code>ispcrime_subset &lt;- select(ispcrime, year:violentCrime, propertyCrime)
ispcrime_subset2 &lt;- ispcrime_subset %&gt;%
  add_predictions(my_lmfit) %&gt;%
  add_residuals(my_lmfit)

head(ispcrime_subset2)</code></pre>
<pre><code>##   year    county violentCrime propertyCrime      pred      resid
## 1 2011     Adams          218          1555 230.24816 -12.248156
## 2 2011 Alexander          119           290 -21.95172 140.951715
## 3 2011      Bond            6           211 -37.70175  43.701747
## 4 2011     Boone           59           733  66.36808  -7.368081
## 5 2011     Brown            7            38 -72.19232  79.192322
## 6 2011    Bureau           42           505  20.91229  21.087706</code></pre>
<hr />
</div>
</div>
</div>
<div id="generalized-linear-models" class="section level1">
<h1>Generalized linear models</h1>
<p style="font-size:1.5em">
<span class="math display">\[\text{E}[\boldsymbol{\text{Y}}] = \mu = g^{-1}(\boldsymbol{\text{X}\beta})\]</span> <span class="math display">\[\text{Var}[\boldsymbol{\text{Y}}] = \text{V}[\mu] = \text{V}[g^{-1}(\boldsymbol{\text{X}}\boldsymbol{\beta})]\]</span>
</p>
<div id="glm-basics" class="section level2">
<h2>GLM basics</h2>
<p>The generalized linear model (GLM) extends the linear model to fit response variables with error distribution other than a gaussian distribution.</p>
<p>Three components of GLM are:</p>
<ul>
<li>A probability distribution from the exponential family</li>
<li>A linear predictor, <span class="math inline">\(\eta = \boldsymbol{\text{X}\beta}\)</span></li>
<li>A link function <span class="math inline">\(g\)</span>, such that <span class="math inline">\(\text{E}[\boldsymbol{\text{Y}}] = \mu = g^{-1}(\eta)\)</span></li>
</ul>
<p>See <a href="https://en.wikipedia.org/wiki/Generalized_linear_model">this Wikipedia article</a> for more on GLM and the model components.</p>
</div>
<div id="the-glm-function" class="section level2">
<h2>The glm() function</h2>
<pre class="r"><code>glm(formula, family = gaussian, data, ...)</code></pre>
<p>R offers the <code>glm()</code> function to fit GLM models. <code>glm()</code> uses <code>formula</code> to specify the model. Then, it uses <code>family</code> input to specify the link function <span class="math inline">\(g\)</span>. The default is <code>gaussian(link = &quot;identity&quot;)</code>, which corresponds to the linear model.</p>
<p><code>glm()</code> function returns a <code>glm</code> class object, which has a <code>summary()</code> method to inspect the model estimation results.</p>
<div id="family-objects" class="section level3">
<h3><code>family</code> objects</h3>
<p>The following table lists GLM <code>family</code> options available for <code>glm()</code>:</p>
<table>
<thead>
<tr class="header">
<th align="left">family</th>
<th align="left">Default link function</th>
<th align="left">Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>gaussian</code></td>
<td align="left"><code>(link = &quot;identity&quot;)</code></td>
<td align="left">Linear model for continous outcome<br>(ordinary linear regression; OLS)</td>
</tr>
<tr class="even">
<td align="left"><code>binomial</code></td>
<td align="left"><code>(link = &quot;logit&quot;)</code></td>
<td align="left">Logit model for binary outcome<br>(logistic regression)</td>
</tr>
<tr class="odd">
<td align="left"><code>poisson</code></td>
<td align="left"><code>(link = &quot;log&quot;</code>)</td>
<td align="left">Poisson model for count outcome</td>
</tr>
<tr class="even">
<td align="left"><code>Gamma</code></td>
<td align="left"><code>(link = &quot;inverse&quot;)</code></td>
<td align="left">…</td>
</tr>
<tr class="odd">
<td align="left"><code>inverse.gaussian</code></td>
<td align="left"><code>(link = &quot;1/mu^2&quot;)</code></td>
<td align="left">…</td>
</tr>
<tr class="even">
<td align="left"><code>quasi</code></td>
<td align="left"><code>(link = &quot;identitiy&quot;)</code></td>
<td align="left">…</td>
</tr>
<tr class="odd">
<td align="left"><code>quasibinomial</code></td>
<td align="left"><code>(link = &quot;logit&quot;)</code></td>
<td align="left">…</td>
</tr>
<tr class="even">
<td align="left"><code>quasipoisson</code></td>
<td align="left"><code>(link = &quot;log&quot;)</code></td>
<td align="left">…</td>
</tr>
</tbody>
</table>
</div>
<div id="logit-model" class="section level3">
<h3>Logit model</h3>
<pre class="r"><code>glm(formula, family = binomial, data, ...)</code></pre>
<p>A logit model, i.e. logistic regression, can be fitted using <code>glm()</code> with <code>family = binomial</code>. The response variable must range between 0 and 1 (an error will be thrown otherwise).</p>
</div>
<div id="poisson-model" class="section level3">
<h3>Poisson model</h3>
<pre class="r"><code>glm(formula, family = poisson, data, ...)</code></pre>
<p>A possion model can be fitted using <code>glm()</code> with <code>family = poisson</code>. Here, the response variable must not include negative values (an error will be thrown otherwise).</p>
</div>
</div>
<div id="better-ways" class="section level2">
<h2>Better ways?</h2>
<p>There are thrid-party packages to provide additional fuctions and/or different interfaces to existing statistical analysis functions. Although I have little exposure to them, the following two might be worth checking:</p>
<ul>
<li><p><code>psych</code> package. See <a href="https://cran.r-project.org/web/packages/psych/vignettes/intro.pdf">this package vignette</a> by the package author to learn more about it.</p></li>
<li><p><code>jmv</code> package. See <a href="https://www.jamovi.org/jmv/">this package documentation page</a> to learn more about it.</p></li>
</ul>
</div>
<div id="resources" class="section level2">
<h2>Resources</h2>
<p>Just as in any previous work module parts, what we have seen in this part is only an introduction tot he topic. The following are some useful resources that would help you to deepen your understanding of the basic statistics in R.</p>
<ul>
<li>Kabacoff, R. <a href="https://www.statmethods.net/stats/index.html">“Statistics”</a>. <em>Quick-R</em>.</li>
<li>Lane D. et al. <a href="http://onlinestatbook.com/2/index.html"><em>Online Statistics: A Multimedia Course of Study</em></a>.</li>
<li>Prabhakaran, S. <a href="http://r-statistics.co/">r-statistics.co</a>.</li>
<li>UCLA Institute for Digital Research and Education. <a href="https://stats.idre.ucla.edu/r/">“R”</a>.</li>
<li>University of Cincinnati. <a href="http://uc-r.github.io/descriptive">“Descriptive analytics”</a>. <em>UC Business Analytic R Programming Guide</em>.</li>
<li>University of Cincinnati. <a href="http://uc-r.github.io/predictive">“Predictive analytics”</a>. <em>UC Business Analytic R Programming Guide</em>.</li>
<li>Wollschlaeger, D. <a href="http://dwoll.de/rexrepos/index.html"><em>RExRepos</em></a>.</li>
<li>Yau, C. <a href="http://www.r-tutor.com/elementary-statistics">“Elementary Statistics with R”</a>. <em>R Tutorial</em>.</li>
</ul>
<hr />
</div>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<ul>
<li>
Lane D. et al. (n.d.). <a href="http://onlinestatbook.com/2/index.html"><span style="font-style:italic">Online Statistics: A Multimedia Course of Study</span></a>.
</li>
<li>
Prabhakaran, S. (n.d.). <a href="http://r-statistics.co/Statistical-Tests-in-R.html">“Statistic Tests”</a>. <i>r-statistics.co</i>.
</li>
<li>
<a href="https://github.com/tidyverse/broom">tidyverse/broom Github repository</a>
</li>
<li>
<a href="https://github.com/tidyverse/modelr">tidyverse/modelr Github repository</a>
</li>
<li>
University of Cincinnati. <i><a href="http://uc-r.github.io/">UC Business Analytics R Programming Guide</a></i>
</li>
<li>
Wikipedia contributors. (2018). <a href="https://en.wikipedia.org/wiki/Generalized_linear_model">“Generalized linear model”</a>. <i>Wikipedia, The Free Encyclopedia</i>.
</li>
</ul>
</div>

<footer>
  <p>Copyright &copy; 2018 Bobae Kang. All rights reserved.</p>
  <a href="https://github.com/bobaekang/" class="icon-footer">
    <i class="fa fa-github fa-2x"></i>
  </a>
  <a href="https://www.linkedin.com/in/bobaekang/" class="icon-footer">
    <i class="fa fa-linkedin-square fa-2x"></i>
  </a>
</footer>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
