<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Bobae Kang" />

<meta name="date" content="2018-03-28" />

<title>R Workshop: Module 3 (1)</title>

<script src="notes_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="notes_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="notes_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="notes_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="notes_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="notes_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="notes_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="notes_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="notes_files/navigation-1.1/tabsets.js"></script>
<link href="notes_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="notes_files/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="../css/style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="header">



<h1 class="title toc-ignore">R Workshop: Module 3 (1)</h1>
<h4 class="author"><em>Bobae Kang</em></h4>
<h4 class="date"><em>March 28, 2018</em></h4>

</div>


<!-- fontawesome CDN -->
<p><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"></p>
<!-- logo -->
<div class="logo">
<p><a href="http://www.icjia.state.il.us/"><img src="../images/icjia.png" alt="ICJIA logo"></img></a></p>
</div>
<p>This page contains the notes for <strong>the first part of R Workshop Module 3: Data Analysis with R</strong>, which is part of the R Workshop series prepared by ICJIA Research Analyst <a href="http://www.icjia.state.il.us/biographies/bobae-kang">Bobae Kang</a> to enable and encourage ICJIA researchers to take advantage of R, a statistical programming language that is one of the most powerful modern research tools.</p>
<div id="links" class="section level3">
<h3>Links</h3>
<p>Click <a href="../index.html"><strong>here</strong></a> to go to the workshop <strong>home page</strong>.</p>
<p>Click <a href="../modules.html"><strong>here</strong></a> to go to the workshop <strong>Modules page</strong>.</p>
<p>Click <a href="../slides/module3_slides1.html"><strong>here</strong></a> to view the accompanying <strong>slides for Module 3, Part 1</strong>.</p>
<p>Navigate to the other workshop materials:</p>
<button class="btn" data-toggle="collapse" data-target="#collapse-navigate" aria-expanded="false" aria-controls="collapse-navigate">
<strong>SEE MORE</strong>
</button>
<div id="collapse-navigate" class="collapse mt-1">
<div style="padding:20px;">
<ul>
<li><strong>Module 1: Introduction to R</strong> (<a href="../slides/module1_slides.html"><strong>slides</strong></a>, <a href="module1_notes.html"><strong>note</strong></a>)</li>
<li><strong>Module 2: R basics</strong>
<ul>
<li>Part 1 (<a href="../slides/module2_slides1.html"><strong>slides</strong></a>, <a href="module2_notes1.html"><strong>note</strong></a>)</li>
<li>Part 2 (<a href="../slides/module2_slides2.html"><strong>slides</strong></a>, <a href="module2_notes2.html"><strong>note</strong></a>)</li>
</ul></li>
<li><strong>Module 3: Data analysis with R</strong>
<ul>
<li>Part 2 (<a href="../slides/module3_slides2.html"><strong>slides</strong></a>, <a href="module3_notes2.html"><strong>note</strong></a>)</li>
</ul></li>
<li><strong>Module 4: Data visualization with R</strong>
<ul>
<li>Part 1 (<a href="../slides/module4_slides1.html"><strong>slides</strong></a>, <a href="module4_notes1.html"><strong>note</strong></a>)</li>
<li>Part 2 (<a href="../slides/module4_slides2.html"><strong>slides</strong></a>, <a href="module4_notes2.html"><strong>note</strong></a>)</li>
</ul></li>
<li><strong>Module 5: Statistical modeling with R</strong>
<ul>
<li>Part 1 (<a href="../slides/module5_slides1.html"><strong>slides</strong></a>, <a href="module5_notes1.html"><strong>note</strong></a>)</li>
<li>Part 2 (<a href="../slides/module5_slides2.html"><strong>slides</strong></a>, <a href="module5_notes2.html"><strong>note</strong></a>)</li>
</ul></li>
<li><strong>Module 6: “To Infinity and Beyond”</strong>
<ul>
<li>Part 1 (<a href="../slides/module6_slides1.html"><strong>slides</strong></a>, <a href="module6_notes1.html"><strong>note</strong></a>)</li>
<li>Part 2 (<a href="../slides/module6_slides2.html"><strong>slides</strong></a>, <a href="module6_notes2.html"><strong>note</strong></a>)</li>
</ul></li>
</ul>
</div>
</div>
<hr />
</div>
<div id="data-analysis-with-r-1-getting-started-with-tidyverse" class="section level1">
<h1>Data Analysis with R (1): Getting started with <code>tidyverse</code></h1>
<img src="https://d33wubrfki0l68.cloudfront.net/071952491ec4a6a532a3f70ecfa2507af4d341f9/c167c/images/hex-dplyr.png" width="20%" style="box-shadow: none; margin-left: 20%" /><img src="https://d33wubrfki0l68.cloudfront.net/5f8c22ec53a1ac61684f3e8d59c623d09227d6b9/b15de/images/hex-tidyr.png" width="20%" style="box-shadow: none; margin-left: 20%" />
<div style="font-size:0.5em; text-align:center; color: #777;">
<p>Source: <a href="https://www.tidyverse.org/">tidyverse.org</a></p>
</div>
<hr />
</div>
<div id="getting-ready" class="section level1">
<h1>Getting Ready</h1>
<div id="installing-the-packages" class="section level2">
<h2>Installing the packages</h2>
<ul>
<li>Installing all <code>tidyverse</code> packages can be easily done with the follwoing command:</li>
</ul>
<pre class="r"><code># Install from CRAN
install.packages(&quot;tidyverse&quot;)

# Or the development version from GitHub
# install.packages(&quot;devtools&quot;)
devtools::install_github(&quot;hadley/tidyverse&quot;)</code></pre>
<ul>
<li>Installing <code>tidyverse</code> package installs the following:
<ul>
<li>core tidyverse packages
<ul>
<li><code>ggplot2</code>, <code>dplyr</code>, <code>tidyr</code>, <code>readr</code>, <code>purrr</code>, <code>tibble</code></li>
</ul></li>
<li>packages to work with specific vector types
<ul>
<li><code>hms</code>, <code>stringr</code>, <code>lubridate</code>, <code>forcats</code></li>
</ul></li>
<li>packages to import data
<ul>
<li><code>feather</code>, <code>haven</code>, <code>httr</code>, <code>jsonlite</code>, <code>readxl</code>, <code>rvest</code>, <code>xml2</code></li>
</ul></li>
<li>packages to facilitate statistical modeling
<ul>
<li><code>modelr</code>, <code>broom</code></li>
</ul></li>
</ul></li>
<li>Of course, each pacakge can be installed separately:</li>
</ul>
<pre class="r"><code># Install ggplot2
install.packages(&quot;ggplot2&quot;)

# Install both dplyr and tidyr with a single commend
#   with a character vector of the package names 
install.packages(c(&quot;dplyr&quot;, &quot;tidyr&quot;))</code></pre>
</div>
<div id="importing-the-packages" class="section level2">
<h2>Importing the packages</h2>
<ul>
<li>Once installed, we can now import the packages using <code>library()</code>:</li>
</ul>
<pre class="r"><code># This imports the core tidyverse packages
library(tidyverse)

# Or import packages separately
library(dplyr)
library(tidyr)</code></pre>
<hr />
</div>
</div>
<div id="manipulating-your-data" class="section level1">
<h1>Manipulating Your Data</h1>
<img src="https://d33wubrfki0l68.cloudfront.net/071952491ec4a6a532a3f70ecfa2507af4d341f9/c167c/images/hex-dplyr.png" width="25%" style="box-shadow: none; display: block; margin: auto;" />
<div style="font-size:0.5em; text-align:center; color: #777;">
<p>Source: <a href="https://www.tidyverse.org/">tidyverse.org</a></p>
</div>
<div id="key-dplyr-functions" class="section level2">
<h2>Key dplyr functions</h2>
<ul>
<li><code>arange()</code></li>
<li><code>select()</code> <code>rename()</code></li>
<li><code>filter()</code></li>
<li><code>mutate()</code> <code>transmute()</code></li>
<li><code>left_join()</code></li>
<li><code>summarise()</code></li>
<li><code>group_by()</code> <code>ungroup()</code></li>
<li><code>%&gt;%</code>, the pipe operator</li>
</ul>
</div>
<div id="sort-rows-by-variables" class="section level2">
<h2>Sort rows by variables</h2>
<pre class="r"><code>arrange(tbl, ...)</code></pre>
<ul>
<li>The first argument is a tabular data object
<ul>
<li>e.g. <code>data.frame</code> or <code>tibble</code></li>
</ul></li>
<li>Columns by which to sort the data as other arguments
<ul>
<li>Multiple columns can be used to sort the data</li>
<li>When multiple columns are given, sorting is done hierarchically</li>
<li>Sorting in a descending order with <code>desc()</code></li>
</ul></li>
</ul>
<div id="example" class="section level3">
<h3>Example</h3>
<pre class="r"><code># without using pipe
head(arrange(ispcrime, county))

# with using pipe
ispcrime %&gt;%
  arrange(county) %&gt;%
  head()</code></pre>
<pre><code>##   year    county violentCrime murder rape robbery aggAssault propertyCrime
## 1 2011     Adams          218      0   37      15        166          1555
## 2 2012     Adams          205      0   28      16        161          1587
## 3 2013     Adams          222      1   33      21        167          1564
## 4 2014     Adams          222      2   34      13        173          1550
## 5 2015     Adams          227      5   39       9        174          1268
## 6 2011 Alexander          119      0   14       4        101           290
##   burglary larcenyTft MVTft arson
## 1      272       1241    36     6
## 2      287       1261    30     9
## 3      297       1204    55     8
## 4      305       1201    39     5
## 5      274        944    43     7
## 6       92        183    11     4</code></pre>
<pre class="r"><code># sort by county and year, in a DESCENDING order
ispcrime %&gt;%
  arrange(desc(county)) %&gt;%
  head() </code></pre>
<pre><code>##   year    county violentCrime murder rape robbery aggAssault propertyCrime
## 1 2011  Woodford           15      1    4       0         10           350
## 2 2012  Woodford           23      0    3       1         19           405
## 3 2013  Woodford           17      0   10       2          5           349
## 4 2014  Woodford           25      0    4       0         21           283
## 5 2015  Woodford           29      0    5       0         24           227
## 6 2011 Winnebago         2430     27  150     622       1631         10569
##   burglary larcenyTft MVTft arson
## 1       90        247    10     3
## 2       65        329    10     1
## 3       81        257    11     0
## 4       50        218    13     2
## 5       35        186     6     0
## 6     2635       7239   598    97</code></pre>
</div>
</div>
<div id="filter-rows-with-conditions" class="section level2">
<h2>Filter rows with conditions</h2>
<pre class="r"><code>filter(tbl, ...)</code></pre>
<ul>
<li>The first argument is a tabular data object</li>
<li>The following arguments are conditional expressions
<ul>
<li>Only the rows satisfying the given conditions are kept</li>
</ul></li>
</ul>
<div id="example-1" class="section level3">
<h3>Example</h3>
<pre class="r"><code>ispcrime %&gt;%
  filter(
    year == 2015,
    murder &gt; 0
  ) %&gt;%
  head()</code></pre>
<pre><code>##   year    county violentCrime murder rape robbery aggAssault propertyCrime
## 1 2015     Adams          227      5   39       9        174          1268
## 2 2015      Bond            5      1    0       0          4           130
## 3 2015    Bureau           53      1   17       4         31           360
## 4 2015 Champaign          918      7  127     205        579          5568
## 5 2015     Coles          173      1   33      14        125           632
## 6 2015      Cook        28791    534 1911   11217      15129        124784
##   burglary larcenyTft MVTft arson
## 1      274        944    43     7
## 2       39         84     7     0
## 3      110        244     6     0
## 4     1100       4235   196    37
## 5      146        463    13    10
## 6    20550      90675 12547  1012</code></pre>
</div>
</div>
<div id="select-andor-rename-variables" class="section level2">
<h2>Select and/or rename variables</h2>
<pre class="r"><code>select(tbl, ...)
rename(tbl, ...)</code></pre>
<ul>
<li>The first argument is a tabular data object</li>
<li>The following argumetns are columns to select/rename
<ul>
<li><code>select()</code> returns the selected columns only while <code>rename()</code> keeps all columns</li>
<li>Renaming each selected column is also possible with <code>select()</code></li>
</ul></li>
<li><code>select()</code> can be also used to exclude a section of columns using a minus (<code>-</code>) sign while keeping the rest.</li>
</ul>
<div id="example-2" class="section level3">
<h3>Example</h3>
<pre class="r"><code># select with renaming columns
ispcrime %&gt;%
  select(year, county, v_crime = violentCrime, p_crime = propertyCrime) %&gt;%
  head()</code></pre>
<pre><code>##   year    county v_crime p_crime
## 1 2011     Adams     218    1555
## 2 2011 Alexander     119     290
## 3 2011      Bond       6     211
## 4 2011     Boone      59     733
## 5 2011     Brown       7      38
## 6 2011    Bureau      42     505</code></pre>
<pre class="r"><code># excluding columns
ispcrime %&gt;%
  select(-violentCrime, -propertyCrime) %&gt;%
  head()</code></pre>
<pre><code>##   year    county murder rape robbery aggAssault burglary larcenyTft MVTft
## 1 2011     Adams      0   37      15        166      272       1241    36
## 2 2011 Alexander      0   14       4        101       92        183    11
## 3 2011      Bond      1    0       0          5       58        147     5
## 4 2011     Boone      0   24       8         27      152        563    14
## 5 2011     Brown      0    1       0          6       14         22     1
## 6 2011    Bureau      0    4       3         35       90        405     8
##   arson
## 1     6
## 2     4
## 3     1
## 4     4
## 5     1
## 6     2</code></pre>
</div>
</div>
<div id="transform-and-add-variables" class="section level2">
<h2>Transform and add variables</h2>
<pre class="r"><code>transmute(tbl, ...)
mutate(tbl, ...)</code></pre>
<ul>
<li>The first argument is a tabular data object</li>
<li>The following arguments transform or add columns
<ul>
<li>An exisiting column is modified with an expression with the same column name</li>
<li>A new column is created with an expression having a new column name</li>
<li><code>transmute()</code> returns the transformed/added columns only while <code>mutate()</code> keeps all columns</li>
</ul></li>
</ul>
<div id="example-3" class="section level3">
<h3>Example</h3>
<pre class="r"><code>ispcrime %&gt;%
  mutate(totalCrime = violentCrime + propertyCrime) %&gt;%
  head()</code></pre>
<pre><code>##   year    county violentCrime murder rape robbery aggAssault propertyCrime
## 1 2011     Adams          218      0   37      15        166          1555
## 2 2011 Alexander          119      0   14       4        101           290
## 3 2011      Bond            6      1    0       0          5           211
## 4 2011     Boone           59      0   24       8         27           733
## 5 2011     Brown            7      0    1       0          6            38
## 6 2011    Bureau           42      0    4       3         35           505
##   burglary larcenyTft MVTft arson totalCrime
## 1      272       1241    36     6       1773
## 2       92        183    11     4        409
## 3       58        147     5     1        217
## 4      152        563    14     4        792
## 5       14         22     1     1         45
## 6       90        405     8     2        547</code></pre>
</div>
</div>
<div id="merge-tables" class="section level2">
<h2>Merge tables</h2>
<pre class="r"><code>left_join(tbl1, tbl2, by = NULL, ...)</code></pre>
<ul>
<li>The first two arguments are tabular data objects to join</li>
<li><code>by</code> takes a chracter vector containing a selection of variables to join tables by
<ul>
<li>By default, all columns with common names are used</li>
</ul></li>
<li>Other types of join: <code>inner_join()</code>, <code>right_join()</code>, <code>semi_join()</code>, <code>anti_join()</code>, <code>full_join()</code></li>
</ul>
<div id="example-4" class="section level3">
<h3>Example</h3>
<pre class="r"><code>ispcrime %&gt;%
  left_join(regions, by = &quot;county&quot;) %&gt;%
  head()</code></pre>
<pre><code>##   year    county violentCrime murder rape robbery aggAssault propertyCrime
## 1 2011     Adams          218      0   37      15        166          1555
## 2 2011 Alexander          119      0   14       4        101           290
## 3 2011      Bond            6      1    0       0          5           211
## 4 2011     Boone           59      0   24       8         27           733
## 5 2011     Brown            7      0    1       0          6            38
## 6 2011    Bureau           42      0    4       3         35           505
##   burglary larcenyTft MVTft arson   region
## 1      272       1241    36     6  Central
## 2       92        183    11     4 Southern
## 3       58        147     5     1 Southern
## 4      152        563    14     4 Northern
## 5       14         22     1     1  Central
## 6       90        405     8     2  Central</code></pre>
</div>
</div>
<div id="aggregate-and-summarise-rows" class="section level2">
<h2>Aggregate and summarise rows</h2>
<pre class="r"><code>summarise(tbl, ...)
summarize(tbl, ...)</code></pre>
<ul>
<li>The first argument is a tabular data object</li>
<li>The following arguments are expressions to summarise data
<ul>
<li><code>summarise()</code> and <code>summarize()</code> are identical</li>
<li>each summary column resulting from each summarizing expression can be given a name</li>
</ul></li>
</ul>
<div id="example-5" class="section level3">
<h3>Example</h3>
<pre class="r"><code>ispcrime %&gt;%
  summarise(
    violentCrimeAverage = mean(violentCrime, na.rm = TRUE),
    propertyCrimeAverage = mean(propertyCrime, na.rm = TRUE)
  )</code></pre>
<pre><code>##   violentCrimeAverage propertyCrimeAverage
## 1            500.9702             2912.905</code></pre>
</div>
</div>
<div id="group-by-variables" class="section level2">
<h2>Group by variables</h2>
<pre class="r"><code>group_by(tbl, ...)
ungroup(tbl, ...)</code></pre>
<ul>
<li>The first argument is a tabular data object</li>
<li>The following arguments are columns by which to group the data</li>
<li><code>group_by()</code> and <code>ungroup()</code> are the opposite operations</li>
<li><code>group_by()</code> can be used in combination with other function to allow for group-specific data manipulations</li>
</ul>
<div id="example-6" class="section level3">
<h3>Example</h3>
<pre class="r"><code>ispcrime %&gt;%
  group_by(year)</code></pre>
<pre><code>## # A tibble: 510 x 12
## # Groups:   year [5]
##     year county violentCrime murder  rape robbery aggAssault propertyCrime
##    &lt;int&gt; &lt;fct&gt;         &lt;int&gt;  &lt;int&gt; &lt;int&gt;   &lt;int&gt;      &lt;int&gt;         &lt;int&gt;
##  1  2011 Adams           218      0    37      15        166          1555
##  2  2011 Alexa~          119      0    14       4        101           290
##  3  2011 Bond              6      1     0       0          5           211
##  4  2011 Boone            59      0    24       8         27           733
##  5  2011 Brown             7      0     1       0          6            38
##  6  2011 Bureau           42      0     4       3         35           505
##  7  2011 Calho~           13      0     0       0         13            56
##  8  2011 Carro~            8      0     1       0          7           206
##  9  2011 Cass             12      0     1       0         11           119
## 10  2011 Champ~         1210      5   127     208        870          5332
## # ... with 500 more rows, and 4 more variables: burglary &lt;int&gt;,
## #   larcenyTft &lt;int&gt;, MVTft &lt;int&gt;, arson &lt;int&gt;</code></pre>
<pre class="r"><code>ispcrime %&gt;%
  group_by(year) %&gt;%
  summarise(
    violentCrimeAverage = mean(violentCrime, na.rm = TRUE),
    propertyCrimeAverage = mean(propertyCrime, na.rm = TRUE)
  )</code></pre>
<pre><code>## # A tibble: 5 x 3
##    year violentCrimeAverage propertyCrimeAverage
##   &lt;int&gt;               &lt;dbl&gt;                &lt;dbl&gt;
## 1  2011                 538                 3329
## 2  2012                 520                 3192
## 3  2013                 503                 2940
## 4  2014                 464                 2609
## 5  2015                 478                 2481</code></pre>
</div>
</div>
<div id="chain-operations" class="section level2">
<h2>Chain operations</h2>
<p>We have been using the pipe operator, <code>%&gt;%</code>, in our code examples. Now is a good time to take a closer look at it.</p>
<pre class="r"><code>data %&gt;% function1(arg2, ...) %&gt;% ...</code></pre>
<p><code>%&gt;%</code> is a binary operator that requires two objects for it to work on. Think of <code>+</code> as another example of a binary operator. In the case of <code>%&gt;%</code> the object preciding the operator has to be the first argument for the function that follows the oprator. In other words, the preceding object is injected into the following function as its first argument. The result of the <code>%&gt;%</code> operator is the output of the function.</p>
<p>In fact, as we have already seen before, multiple functions can be chained, or “piped,” using <code>%&gt;%</code> as long as the output of the first “piping” generates a suitable object for the first argument of the next function to be chained.</p>
<p>with piping, we can have a coding style that is cleaner and more intuitive–that reflects the way we think about how we apply the operations to the object, rather than the tranditional syntax where the function that acts on the last comes at the beginning of the statement:</p>
<pre class="r"><code># piping style
object %&gt;%
  function1(arguments1) %&gt;%
  function2(arguments2) %&gt;%
  function3(arguments3)


# traditional style
function3(
  function2(
    function1(
      object,
      arguments1
    ),
    arguments2
  ),
  arguments3  
  
)

# or
function3(function2(function1(object, arguments1), arguments2), arguments3)</code></pre>
</div>
<div id="dplyr-in-action" class="section level2">
<h2><code>dplyr</code> in action</h2>
<p>Let’s take a look at more concrete examples of using <code>dplyr</code> functions to work on data manipulation and analysis. For those of you who were there at my presentation for the February R&amp;A meeting, these are the some of the examples used in that presentation–now we can understand them better!</p>
<div id="example-1-1" class="section level3">
<h3>Example 1</h3>
<pre class="r"><code>ispcrime %&gt;%
  filter(substr(county, 1, 1) == &quot;D&quot;, year %in% c(2014, 2015)) %&gt;%
  mutate(totalCrime = violentCrime + propertyCrime) %&gt;%
  select(year, county, totalCrime)</code></pre>
<pre><code>##   year  county totalCrime
## 1 2014 De Kalb       2218
## 2 2014 De Witt        182
## 3 2014 Douglas        116
## 4 2014 Du Page      12576
## 5 2015 De Kalb       2173
## 6 2015 De Witt        140
## 7 2015 Douglas        173
## 8 2015 Du Page      12538</code></pre>
<p>In this example, we we want to answer the following question: What are the total crime count in 2014 and 2015 for counties whose name starts with letter D?</p>
<ol style="list-style-type: decimal">
<li>We start with <code>ispcrime</code> data</li>
<li>We use the pipe operator to feed the <code>ispcrime</code> data into <code>filter()</code>
<ul>
<li>we have two filtering conditions. First condition is that the first letter of the <code>county</code> column value matches “D” (<code>substr(county, 1, 1) == &quot;D&quot;</code>)</li>
<li>Second condition is that the <code>year</code> column value has to be either 2014 or 2015 (<code>year %in% c(2014, 2015)</code>)</li>
</ul></li>
<li>We use the pipe operator to feed the filtered data into <code>mutate()</code>
<ul>
<li>Here we create a new column named <code>totalCrime</code>, which is the sume of <code>violentCrime</code> and <code>propertyCrime</code> values</li>
</ul></li>
<li>Finally, we use the filtered <em>and</em> mutated data into <code>select()</code>
<ul>
<li>The final output will include <code>year</code>, <code>county</code>, and <code>totalCrime</code> columns only.</li>
</ul></li>
</ol>
</div>
<div id="example-2-1" class="section level3">
<h3>Example 2</h3>
<pre class="r"><code>ispcrime %&gt;%
  left_join(regions) %&gt;%
  group_by(region, county) %&gt;%
  summarise(annualAvgCrime = sum(violentCrime, propertyCrime, na.rm = TRUE) / n()) %&gt;%
  arrange(desc(annualAvgCrime))</code></pre>
<pre><code>## # A tibble: 102 x 3
## # Groups:   region [4]
##    region   county    annualAvgCrime
##    &lt;fct&gt;    &lt;fct&gt;              &lt;dbl&gt;
##  1 Cook     Cook              182818
##  2 Northern Du Page            14316
##  3 Northern Lake               12779
##  4 Northern Winnebago          12275
##  5 Northern Will               11078
##  6 Southern St. Clair           9262
##  7 Central  Sangamon            8876
##  8 Northern Kane                8332
##  9 Central  Peoria              7229
## 10 Central  Champaign           6567
## # ... with 92 more rows</code></pre>
<p>In this example, we we want to answer the following question: what is the annual average of the crime count per county, shown with the region it belongs to and sorted by the average count?</p>
<ol style="list-style-type: decimal">
<li>We start with <code>ispcrime</code> data</li>
<li>We use the pipe operator to feed the <code>ispcrime</code> data into <code>left_join()</code>
<ul>
<li>This is to add <code>region</code> column from <code>regions</code> table to our data</li>
</ul></li>
<li>We use the pipe operator to feed the joined data into <code>group_by()</code>
<ul>
<li>We group the data by values of the <code>region</code> and <code>county</code> column.</li>
</ul></li>
<li>We use the pipe operator to feed the grouped data into <code>summarise()</code>
<ul>
<li>We summarise data by group to get the annual average crime, a sum of <code>violentCrime</code> and <code>propertyCrime</code>, divided by total counts. Since the input is grouped, the summarising work is also done by group.</li>
</ul></li>
<li>We use the pipe operator to feed the grouped and summarised data into <code>arrange()</code>
<ul>
<li>Here we sort the data by the newly created column, <code>annualAvgCrime</code>, in a descending order</li>
</ul></li>
</ol>
</div>
</div>
<div id="more-on-dplyr" class="section level2">
<h2>More on <code>dplyr</code></h2>
<p>What we have seen is only a tip of an iceberg that is <code>dplyr</code>. Although the aforementioned functions are among the most commonly used in usual data manipulation and analysis tasks, the description and examples here are by no means comprehensive. Also, <code>dplyr</code> offers many other functions to facilitate data manipulation work. I recommend you to check out the following resources to learn more about <code>dplyr</code>:</p>
<ul>
<li><code>dplyr</code> on <a href="http://dplyr.tidyverse.org/">tidyverse.org</a></li>
<li><code>dplyr</code> <a href="https://cran.r-project.org/web/packages/dplyr/dplyr.pdf">CRAN documentation</a></li>
<li><code>dplyr</code> <a href="https://github.com/tidyverse/dplyr">Github repository</a></li>
</ul>
<hr />
</div>
</div>
<div id="tidying-up-your-data" class="section level1">
<h1>Tidying Up Your Data</h1>
<img src="https://d33wubrfki0l68.cloudfront.net/5f8c22ec53a1ac61684f3e8d59c623d09227d6b9/b15de/images/hex-tidyr.png" width="25%" style="box-shadow: none; display: block; margin: auto;" />
<div style="font-size:0.5em; text-align:center; color: #777;">
<p>Source: <a href="https://www.tidyverse.org/">tidyverse.org</a></p>
</div>
<div id="remember-tidy-data" class="section level2">
<h2>Remember tidy data?</h2>
<img src="../images/tidy-1.png" width="100%" style="box-shadow: none; display: block; margin: auto;" />
<div style="font-size:0.5em; text-align:center; color: #777;">
<p>Source: <a href="http://r4ds.had.co.nz/">R for Data Science</a></p>
</div>
</div>
<div id="key-tidyr-functions" class="section level2">
<h2>Key <code>tidyr</code> functions</h2>
<ul>
<li><code>gather()</code></li>
<li><code>spread()</code></li>
<li><code>unite()</code></li>
<li><code>separate()</code></li>
<li><code>separate_rows()</code></li>
</ul>
</div>
<div id="make-wide-data-longer" class="section level2">
<h2>Make “wide” data longer</h2>
<pre class="r"><code>gather(tbl, key = &quot;key&quot;, value = &quot;value&quot;, ..., na.rm = FALSE, ...)</code></pre>
</div>
<div id="make-long-data-wider" class="section level2">
<h2>Make “long” data wider</h2>
<pre class="r"><code>spread(tbl, key, value, fill = NA, ...)</code></pre>
<div id="example-7" class="section level3">
<h3>Example</h3>
</div>
</div>
<div id="unite-multiple-columns-into-one" class="section level2">
<h2>Unite multiple columns into one</h2>
<pre class="r"><code>unite(tbl, col, ..., sep = &quot;_&quot;, remove = TRUE)</code></pre>
</div>
<div id="split-a-column-into-many" class="section level2">
<h2>Split a column into many</h2>
<pre class="r"><code>separate(tbl, col, into, sep = &quot;[^[:alnum:]]+&quot;, remove = TRUE, ...)</code></pre>
<div id="example-8" class="section level3">
<h3>Example</h3>
</div>
</div>
<div id="split-a-row-into-many" class="section level2">
<h2>Split a row into many</h2>
<pre class="r"><code>separate_rows(tbl, ..., sep = &quot;[^[:alnum:]]+&quot;, ...)</code></pre>
<div id="example-9" class="section level3">
<h3>Example</h3>
</div>
</div>
<div id="more-on-tidyr" class="section level2">
<h2>More on <code>tidyr</code></h2>
<p>As in the earlier <code>dplyr</code> case, what we have seen is only part of what <code>tidyr</code> offers. I recommend you to check out the following resources to learn more about <code>tidyr</code></p>
<ul>
<li><code>tidyr</code> on <a href="http://tidyr.tidyverse.org/">tidyverse.org</a></li>
<li><code>tidyr</code> <a href="https://cran.r-project.org/web/packages/tidyr/tidyr.pdf">CRAN documentation</a></li>
<li><code>tidyr</code> <a href="https://github.com/tidyverse/tidyr">Github repository</a></li>
</ul>
<hr />
</div>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<ul>
<li>
Grolemund, G. &amp; Wickham, H. (2017). <a href="http://r4ds.had.co.nz/"><span style="font-style:italic">R for Data Science</span></a>.
</li>
<li>
RStudio. (2017). <a href="https://www.rstudio.com/resources/cheatsheets/">“Data Import Cheat Sheet”</a>.
</li>
<li>
RStudio. (2017). <a href="https://www.rstudio.com/resources/cheatsheets/">“Data Transformation Cheat Sheet”</a>.
</li>
<li>
Tidyverse. (n.d.). <a href="http://dplyr.tidyverse.org/"><span style="font-style:italic">dplyr.tidyverse.org</span></a>.
</li>
<li>
Tidyverse. (n.d.). <a href="http://tidyr.tidyverse.org/"><span style="font-style:italic">tidyr.tidyverse.org</span></a>.
</li>
<li>
Tidyverse. (n.d.). <a href="http://www.tidyverse.org/"><span style="font-style:italic">tidyverse.org</span></a>.
</li>
</ul>
</div>

<footer>
  <p>Copyright &copy; 2018 Bobae Kang. All rights reserved.</p>
  <a href="https://github.com/bobaekang/" class="icon-footer">
    <i class="fa fa-github fa-2x"></i>
  </a>
  <a href="https://www.linkedin.com/in/bobaekang/" class="icon-footer">
    <i class="fa fa-linkedin-square fa-2x"></i>
  </a>
</footer>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
